# ✅ РЕШЕНИЕ ПРОБЛЕМЫ

## Проблема была найдена!

**Причина:** База данных SQLite была создана со старой схемой (без колонки `referrer_id`), а код пытался использовать новую схему.

## Что нужно сделать:

### 1. Остановите бэкенд
В терминале где запущен `python3 run.py` нажмите **Ctrl+C**

### 2. Удалите старую базу данных и пересоздайте её

Выполните в терминале:

```bash
cd /Users/user/my-new-project/backend
rm -f sql_app.db
python3 -c "from app.database import engine, Base; from app import models; Base.metadata.drop_all(bind=engine); Base.metadata.create_all(bind=engine); print('✅ База пересоздана')"
```

### 3. Установите зависимости в виртуальное окружение

Виртуальное окружение находится в корне проекта. Установите основные зависимости:

```bash
cd /Users/user/my-new-project
source .venv/bin/activate  # Активируйте виртуальное окружение
pip install uvicorn fastapi sqlalchemy python-dotenv pydantic-settings aiohttp python-multipart
```

Или попробуйте установить все зависимости (может быть ошибка с некоторыми пакетами):
```bash
cd /Users/user/my-new-project
source .venv/bin/activate
cd backend
pip install -r requirements.txt
```

### 4. Перезапустите бэкенд

После установки зависимостей запустите бэкенд:

```bash
cd /Users/user/my-new-project/backend
source ../.venv/bin/activate  # Активируйте виртуальное окружение
python3 run.py
```

**Или используйте готовый скрипт:**
```bash
cd /Users/user/my-new-project/backend
./start.sh
```

**Важно:** Используйте `python3 run.py` (с расширением `.py`), а не просто `python3 run`!

### 5. Создайте пользователя и задания

В **новом терминале** выполните:

```bash
# Создаем пользователя
curl -X POST http://localhost:8000/api/users/ \
  -H "Content-Type: application/json" \
  -d '{"telegram_id": 123456789, "username": "test_user", "first_name": "Test"}'

# Инициализируем задания
curl -X POST http://localhost:8000/api/admin/init-test-tasks
```

### 6. Обновите страницу в браузере

Нажмите **F5** или **Cmd+R** в браузере.

---

## После этого всё должно работать! ✅

Если проблемы останутся, отправьте мне:
1. Результат команды `curl http://localhost:8000/health`
2. Логи из терминала где запущен бэкенд


